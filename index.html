<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>グラビア印刷ラーニング v2</title>
  <link rel="stylesheet" href="./styles.css?v=20250808" onload="document.documentElement.dataset.css='ok'">
  <meta name="color-scheme" content="light dark">
  <!-- head内どこかにこれ1行あればOK（vは好きな値で更新） -->
<link rel="stylesheet" href="./styles.css?v=20250809">
 
</head>
<body>
  <div class="topbar">
    <div class="brand"><span>🎨</span><h1>グラビア印刷ラーニング v2</h1></div>
    <div id="stats" class="tag">ロード中…</div>
  </div>
  <main class="safe">
    <section id="diagramPanel" class="panel" hidden>
  <h2>図式モード（入稿 → 色校正 → 製版 → 実機刷り）</h2>
  <div class="diagram-card">
    <svg viewBox="0 0 960 420" role="img" aria-label="gravure flow" class="diagram-svg">
      <defs>
        <marker id="arrow" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="8" markerHeight="8" orient="auto-start-reverse">
          <path d="M 0 0 L 10 5 L 0 10 z" fill="#22c55e"></path>
        </marker>
        <style>
          .bx{rx:14; ry:14; fill:#0b1220; stroke:#334155; stroke-width:2}
          .tx{font: 600 14px/1.3 system-ui, -apple-system, "Noto Sans JP", sans-serif; fill:#e5e7eb}
          .sub{font: 12px system-ui, -apple-system, "Noto Sans JP", sans-serif; fill:#9ca3af}
          .ln{stroke:#22c55e; stroke-width:3; marker-end:url(#arrow)}
          @media (prefers-color-scheme: light){
            .bx{fill:#ffffff; stroke:#cbd5e1}
            .tx{fill:#0f172a} .sub{fill:#64748b}
          }
        </style>
      </defs>

      <!-- 上段メインフロー -->
      <!-- デザイン入稿 -->
      <rect class="bx" x="40"  y="60"  width="200" height="70" rx="14" data-term="デザイン入稿"/>
      <text class="tx" x="140" y="90" text-anchor="middle">デザイン入稿</text>
      <text class="sub" x="140" y="110" text-anchor="middle">データ/プロファイル</text>

      <!-- 色校正 -->
      <rect class="bx" x="300" y="60"  width="200" height="70" rx="14" data-term="色校正"/>
      <text class="tx" x="400" y="90" text-anchor="middle">色校正</text>
      <text class="sub" x="400" y="110" text-anchor="middle">標準見本/ΔE/D50</text>

      <!-- 製版/版 -->
      <rect class="bx" x="560" y="60"  width="200" height="70" rx="14" data-term="グラビア版"/>
      <text class="tx" x="660" y="90" text-anchor="middle">製版 / 版</text>
      <text class="sub" x="660" y="110" text-anchor="middle">セル/線数/彫刻</text>

      <!-- 実機刷り -->
      <rect class="bx" x="820" y="60"  width="100" height="70" rx="14" data-term="刷り出し確認"/>
      <text class="tx" x="870" y="90" text-anchor="middle">実機刷り</text>
      <text class="sub" x="870" y="110" text-anchor="middle">条件最適/QA</text>

      <!-- メイン矢印 -->
      <line class="ln" x1="240" y1="95" x2="300" y2="95"/>   <!-- 入稿→色校 -->
      <line class="ln" x1="500" y1="95" x2="560" y2="95"/>   <!-- 色校→製版 -->
      <line class="ln" x1="760" y1="95" x2="820" y2="95"/>   <!-- 製版→実機 -->

      <!-- 下段（品質キーポイント） -->
      <!-- 白引き -->
      <rect class="bx" x="120" y="240" width="160" height="60" rx="14" data-term="白引き"/>
      <text class="tx" x="200" y="268" text-anchor="middle">白引き</text>

      <!-- 見当/レジ -->
      <rect class="bx" x="360" y="240" width="160" height="60" rx="14" data-term="レジスター"/>
      <text class="tx" x="440" y="268" text-anchor="middle">見当 / レジ</text>

      <!-- 乾燥/残留溶剤 -->
      <rect class="bx" x="600" y="240" width="200" height="60" rx="14" data-term="乾燥不良"/>
      <text class="tx" x="700" y="268" text-anchor="middle">乾燥 / 残留溶剤</text>

      <!-- 下段矢印（白引き→見当/レジ→乾燥）※曲がらず水平で修正 -->
      <line class="ln" x1="280" y1="270" x2="360" y2="270"/>
      <line class="ln" x1="520" y1="270" x2="600" y2="270"/>

      <!-- 白引きから上段の色校正へ戻る補助矢印（短い斜め） -->
      <line class="ln" x1="240" y1="240" x2="340" y2="130"/>
    </svg>
    <div class="diagram-hint">ボックスをタップすると該当用語ページへ移動します</div>
  </div>
</section>

    <section id="tab-glossary" class="panel" hidden>
      <div class="gl-search">
        <input id="gSearch" type="search" class="input" placeholder="用語を検索…" />
        <select id="gCat" class="input" style="max-width:160px">
          <option value="all">すべて</option>
        </select>
      </div>
      <div id="gCount" class="tag" style="margin-top:8px">0 語</div>
      <ul id="gList" style="list-style:none;padding:0;margin:10px 0;display:grid;gap:10px"></ul>
      <div id="gDetail" class="detail" hidden></div>
    </section>

    <section id="tab-diagram" class="panel" hidden>
      <h3 style="margin:6px 0 10px">🗺️ 図式モード（入稿→色校→製版→実機刷り）</h3>
      <div class="diagram-wrap" style="border:1px solid #334155;border-radius:12px;overflow:hidden">
        <svg viewBox="0 0 900 260" style="width:100%;height:auto;background:#0b1220">
          <defs><marker id="arrow" markerWidth="10" markerHeight="10" refX="10" refY="3" orient="auto" markerUnits="strokeWidth">
            <path d="M0,0 L0,6 L9,3 z" fill="#22c55e"></path></marker></defs>
          <g class="node" data-term="デザイン入稿" transform="translate(40,40)">
            <rect rx="12" ry="12" width="180" height="60" fill="#0b1220" stroke="#334155" stroke-width="2"></rect>
            <text x="90" y="38" fill="#e5e7eb" text-anchor="middle" font-size="14" font-weight="700">デザイン入稿</text>
            <text x="90" y="54" fill="#9ca3af" text-anchor="middle" font-size="12">データ/プロファイル</text>
          </g>
          <g class="node" data-term="色校正" transform="translate(260,40)">
            <rect rx="12" ry="12" width="180" height="60" fill="#0b1220" stroke="#334155" stroke-width="2"></rect>
            <text x="90" y="38" fill="#e5e7eb" text-anchor="middle" font-size="14" font-weight="700">色校正</text>
            <text x="90" y="54" fill="#9ca3af" text-anchor="middle" font-size="12">基準/ΔE/D50</text>
          </g>
          <g class="node" data-term="製版/版" transform="translate(480,40)">
            <rect rx="12" ry="12" width="180" height="60" fill="#0b1220" stroke="#334155" stroke-width="2"></rect>
            <text x="90" y="38" fill="#e5e7eb" text-anchor="middle" font-size="14" font-weight="700">製版/版</text>
            <text x="90" y="54" fill="#9ca3af" text-anchor="middle" font-size="12">セル/線数</text>
          </g>
          <g class="node" data-term="実機刷り" transform="translate(700,40)">
            <rect rx="12" ry="12" width="180" height="60" fill="#0b1220" stroke="#334155" stroke-width="2"></rect>
            <text x="90" y="38" fill="#e5e7eb" text-anchor="middle" font-size="14" font-weight="700">実機刷り</text>
            <text x="90" y="54" fill="#9ca3af" text-anchor="middle" font-size="12">条件最適/QA</text>
          </g>
          <g class="node" data-term="白引き" transform="translate(150,150)">
            <rect rx="10" ry="10" width="140" height="46" fill="#0b1220" stroke="#334155" stroke-width="2"></rect>
            <text x="70" y="30" fill="#e5e7eb" text-anchor="middle" font-size="14" font-weight="700">白引き</text>
          </g>
          <g class="node" data-term="見当/レジ" transform="translate(360,150)">
            <rect rx="10" ry="10" width="160" height="46" fill="#0b1220" stroke="#334155" stroke-width="2"></rect>
            <text x="80" y="30" fill="#e5e7eb" text-anchor="middle" font-size="14" font-weight="700">見当/レジ</text>
          </g>
          <g class="node" data-term="残留溶剤" transform="translate(560,150)">
            <rect rx="10" ry="10" width="160" height="46" fill="#0b1220" stroke="#334155" stroke-width="2"></rect>
            <text x="80" y="30" fill="#e5e7eb" text-anchor="middle" font-size="14" font-weight="700">残留溶剤</text>
          </g>
          <line x1="220" y1="70" x2="260" y2="70" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="440" y1="70" x2="480" y2="70" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="660" y1="70" x2="700" y2="70" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="210" y1="170" x2="360" y2="170" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"></line>
          <line x1="520" y1="170" x2="560" y2="170" stroke="#22c55e" stroke-width="2" marker-end="url(#arrow)"></line>
        </svg>
        <div class="tag" style="display:inline-block;margin:8px">ボックスをタップで用語へ</div>
      </div>
    </section>

    <section id="tab-handbook" class="panel" hidden>
      <h3 style="margin:6px 0 10px">📖 参考書モード</h3>
      <div style="display:grid;gap:8px">
        <select id="hbChapter" class="input"></select>
        <select id="hbSection" class="input"></select>
      </div>
      <article id="hbContent" style="margin-top:10px"></article>
    </section>
  </main>

  <nav class="nav">
    <button data-tab="train" class="active"><span class="icon">🧪</span>トレ</button>
    <button data-tab="glossary"><span class="icon">📚</span>用語</button>
    <button data-tab="diagram"><span class="icon">🗺️</span>図式</button>
    <button data-tab="handbook"><span class="icon">📖</span>参考</button>
  </nav>

  <script src="./app.js?v=20250808"></script>
  <script>
window.addEventListener('error', e => {
  const b=document.createElement('div');
  b.style.cssText='position:fixed;left:0;right:0;bottom:0;background:#ef4444;color:#fff;padding:8px 12px;font:14px system-ui;z-index:9999';
  b.textContent='JSエラー: ' + (e.message||'') + ' @ ' + (e.filename||'') + ':' + (e.lineno||'');
  document.body.appendChild(b);
});
</script>
</body>
</html>
